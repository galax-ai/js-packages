{"version":3,"sources":["../lib/text.js"],"sourcesContent":["import { identity } from './functions';\nimport { ValidationError } from './errors';\n\nclass T_TEXT {\n    name = 'text';\n    alias = ['string'];\n    primitive = true;\n    scalar = true;\n    defaultValue = '';\n\n    constructor(system) {\n        this.system = system;\n    }\n\n    validate(value) {\n        return typeof value === 'string';\n    }\n\n    _sanitize(value, meta, opts) {\n        const type = typeof value;\n        const isString = type === 'string';\n\n        if (isString) {\n            if (meta.trim) {\n                value = value.trim();\n            }\n\n            if (value === '' && meta.nonEmpty) {\n                value = null;\n                if (!meta.optional) {\n                    throw new ValidationError('Value ' + (opts.path ? `of \"${opts.path}\" ` : '') + 'is required.', {\n                        value,\n                        meta,\n                        ...opts,\n                    });\n                }\n            }\n        } else {\n            if (type === 'bigint' || type === 'number') {\n                return value.toString();\n            }\n\n            throw new ValidationError('Value ' + (opts.path ? `of \"${opts.path}\" ` : '') + 'is required.', {\n                value,\n                meta,\n                ...opts,\n            });\n        }\n\n        return value;\n    }\n\n    serialize = identity;\n}\n\nexport default T_TEXT;\n"],"names":["T_TEXT","validate","value","_sanitize","meta","opts","type","isString","trim","nonEmpty","optional","ValidationError","path","toString","constructor","system","name","alias","primitive","scalar","defaultValue","serialize","identity"],"mappings":";;;;+BAuDA;;;eAAA;;;2BAvDyB;wBACO;;;;;;;;;;;;;;AAEhC,MAAMA;IAWFC,SAASC,KAAK,EAAE;QACZ,OAAO,OAAOA,UAAU;IAC5B;IAEAC,UAAUD,KAAK,EAAEE,IAAI,EAAEC,IAAI,EAAE;QACzB,MAAMC,OAAO,OAAOJ;QACpB,MAAMK,WAAWD,SAAS;QAE1B,IAAIC,UAAU;YACV,IAAIH,KAAKI,IAAI,EAAE;gBACXN,QAAQA,MAAMM,IAAI;YACtB,CAAC;YAED,IAAIN,UAAU,MAAME,KAAKK,QAAQ,EAAE;gBAC/BP,QAAQ,IAAI;gBACZ,IAAI,CAACE,KAAKM,QAAQ,EAAE;oBAChB,MAAM,IAAIC,uBAAe,CAAC,WAAYN,CAAAA,KAAKO,IAAI,GAAG,CAAC,IAAI,EAAEP,KAAKO,IAAI,CAAC,EAAE,CAAC,GAAG,EAAE,AAAD,IAAK,gBAAgB;wBAC3FV;wBACAE;wBACA,GAAGC,IAAI;oBACX,GAAG;gBACP,CAAC;YACL,CAAC;QACL,OAAO;YACH,IAAIC,SAAS,YAAYA,SAAS,UAAU;gBACxC,OAAOJ,MAAMW,QAAQ;YACzB,CAAC;YAED,MAAM,IAAIF,uBAAe,CAAC,WAAYN,CAAAA,KAAKO,IAAI,GAAG,CAAC,IAAI,EAAEP,KAAKO,IAAI,CAAC,EAAE,CAAC,GAAG,EAAE,AAAD,IAAK,gBAAgB;gBAC3FV;gBACAE;gBACA,GAAGC,IAAI;YACX,GAAG;QACP,CAAC;QAED,OAAOH;IACX;IAxCAY,YAAYC,MAAM,CAAE;QANpBC,uBAAAA,QAAO;QACPC,uBAAAA,SAAQ;YAAC;SAAS;QAClBC,uBAAAA,aAAY,IAAI;QAChBC,uBAAAA,UAAS,IAAI;QACbC,uBAAAA,gBAAe;QA4CfC,uBAAAA,aAAYC,mBAAQ;QAzChB,IAAI,CAACP,MAAM,GAAGA;IAClB;AAyCJ;MAEA,WAAef"}