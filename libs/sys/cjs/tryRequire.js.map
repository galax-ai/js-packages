{"version":3,"sources":["../lib/tryRequire.js"],"sourcesContent":["import { createRequire } from 'node:module';\nimport path from 'node:path';\n\nfunction tryRequireBy(packageName, mainModule, throwWhenNotFound) {\n    try {\n        if (typeof mainModule === 'string') {\n            const require2 = createRequire(\n                mainModule.endsWith('/') || mainModule.endsWith('\\\\') ? mainModule : mainModule + path.sep\n            );\n            return require2(packageName);\n        }\n\n        return mainModule.require(packageName);\n    } catch (error) {\n        if (error.code === 'MODULE_NOT_FOUND') {\n            if (throwWhenNotFound) {\n                let pkgPaths = packageName.split('/');\n                let npmPkgName = pkgPaths[0];\n\n                if (npmPkgName.startsWith('.')) {\n                    //path\n                    throw error;\n                }\n\n                if (npmPkgName.startsWith('@') && pkgPaths.length > 1) {\n                    npmPkgName += '/' + pkgPaths[1];\n                }\n\n                let pos1 = error.message.indexOf(\"'\");\n                let realModuleName = error.message.substr(pos1 + 1);\n                let pos2 = realModuleName.indexOf(\"'\");\n                realModuleName = realModuleName.substr(0, pos2);\n\n                if (realModuleName === packageName) {\n                    throw new Error(\n                        `Module \"${packageName}\" not found. Try run \"npm install ${npmPkgName}\" to install the dependency.`\n                    );\n                }\n\n                throw error;\n            }\n\n            return undefined;\n        }\n\n        throw error;\n    }\n}\n\n/**\n * Try require a package module and show install tips if not found.\n * @alias helpers.tryRequire\n * @param {string} packageName\n * @returns {object}\n */\nfunction tryRequire(packageName, basePath) {\n    if (\n        packageName.startsWith('@') ||\n        path.isAbsolute(packageName) ||\n        // not a path\n        (packageName.indexOf(path.sep) === -1 && !packageName.startsWith('.'))\n    ) {\n        try {\n            return require(packageName);\n        } catch (error) {\n            if (error.code !== 'MODULE_NOT_FOUND') {\n                throw error;\n            }\n        }\n    }\n\n    basePath != null || (basePath = process.cwd());\n\n    return tryRequireBy(packageName, require.main, basePath == null) || tryRequireBy(packageName, basePath, true);\n}\n\nexport default tryRequire;\n"],"names":["tryRequireBy","packageName","mainModule","throwWhenNotFound","require2","createRequire","endsWith","path","sep","require","error","code","pkgPaths","split","npmPkgName","startsWith","length","pos1","message","indexOf","realModuleName","substr","pos2","Error","undefined","tryRequire","basePath","isAbsolute","process","cwd","main"],"mappings":"oGA4EA,iDAAA,sCA5E8B,gEACb,kGAEjB,SAASA,aAAaC,WAAW,CAAEC,UAAU,CAAEC,iBAAiB,CAAE,CAC9D,GAAI,CACA,GAAI,OAAOD,aAAe,SAAU,CAChC,MAAME,SAAWC,GAAAA,yBAAa,EAC1BH,WAAWI,QAAQ,CAAC,MAAQJ,WAAWI,QAAQ,CAAC,MAAQJ,WAAaA,WAAaK,iBAAI,CAACC,GAAG,EAE9F,OAAOJ,SAASH,YACpB,CAAC,AAED,OAAOC,WAAWO,OAAO,CAACR,YAC9B,CAAE,MAAOS,MAAO,CACZ,GAAIA,MAAMC,IAAI,GAAK,mBAAoB,CACnC,GAAIR,kBAAmB,CACnB,IAAIS,SAAWX,YAAYY,KAAK,CAAC,KACjC,IAAIC,WAAaF,QAAQ,CAAC,EAAE,CAE5B,GAAIE,WAAWC,UAAU,CAAC,KAAM,CAE5B,MAAML,KAAM,AAChB,CAAC,AAED,GAAII,WAAWC,UAAU,CAAC,MAAQH,SAASI,MAAM,CAAG,EAAG,CACnDF,YAAc,IAAMF,QAAQ,CAAC,EAAE,AACnC,CAAC,AAED,IAAIK,KAAOP,MAAMQ,OAAO,CAACC,OAAO,CAAC,KACjC,IAAIC,eAAiBV,MAAMQ,OAAO,CAACG,MAAM,CAACJ,KAAO,GACjD,IAAIK,KAAOF,eAAeD,OAAO,CAAC,KAClCC,eAAiBA,eAAeC,MAAM,CAAC,EAAGC,MAE1C,GAAIF,iBAAmBnB,YAAa,CAChC,MAAM,IAAIsB,MACN,CAAC,QAAQ,EAAEtB,YAAY,kCAAkC,EAAEa,WAAW,4BAA4B,CAAC,CACrG,AACN,CAAC,AAED,MAAMJ,KAAM,AAChB,CAAC,AAED,OAAOc,SACX,CAAC,AAED,MAAMd,KAAM,AAChB,CACJ,CAQA,SAASe,WAAWxB,WAAW,CAAEyB,QAAQ,CAAE,CACvC,GACIzB,YAAYc,UAAU,CAAC,MACvBR,iBAAI,CAACoB,UAAU,CAAC1B,cAEfA,YAAYkB,OAAO,CAACZ,iBAAI,CAACC,GAAG,IAAM,CAAC,GAAK,CAACP,YAAYc,UAAU,CAAC,KACnE,CACE,GAAI,CACA,OAAON,QAAQR,YACnB,CAAE,MAAOS,MAAO,CACZ,GAAIA,MAAMC,IAAI,GAAK,mBAAoB,CACnC,MAAMD,KAAM,AAChB,CAAC,AACL,CACJ,CAAC,AAEDgB,UAAY,IAAI,EAAKA,CAAAA,SAAWE,QAAQC,GAAG,EAAC,EAE5C,OAAO7B,aAAaC,YAAaQ,QAAQqB,IAAI,CAAEJ,UAAY,IAAI,GAAK1B,aAAaC,YAAayB,SAAU,IAAI,CAChH,OAEA,SAAeD"}