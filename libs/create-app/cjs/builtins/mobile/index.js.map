{"version":3,"sources":["../../../src/builtins/mobile/index.js"],"sourcesContent":["const path = require(\"path\");\nconst { fs } = require(\"@genx/sys\");\nconst localConfig = require(\"./config\");\nconst { steps, packageConfig } = require(\"../..\");\nconst getTemplatePath = require(\"../../utils/getTemplatePath\");\nconst copyFileFromTemplate_ = require(\"../../utils/createFileFromTemplate_\");\nconst deleteLines_ = require(\"../../utils/deleteLines_\");\n\nmodule.exports = async (app, options) => {\n    const appNameLowerCase = options.appName.toLowerCase();\n    options = {\n        ...localConfig,\n        ...options,\n        appNameLowerCase,\n    };\n\n    const targetPath = path.join(options.workingPath, options.appDir);\n    let cmd = `npx react-native init ${options.appName} --npm`;\n    let cwd;\n\n    if (!fs.existsSync(targetPath)) {\n        cwd = options.workingPath;\n        cmd += ` --directory ${options.appDir}`;\n    } else {\n        cwd = targetPath;\n        cmd += ` --directory .`;\n    }\n\n    await steps.runCommand_(app, cwd, cmd, true);\n\n    if (options.disablePackageLock) {\n        await fs.unlink(path.join(targetPath, \"package-lock.json\"));\n    }\n\n    const templatePath = getTemplatePath(options.appMode);\n\n    await steps.removeFiles_(app, targetPath, [\"app.json\", \".prettierrc.js\", \"App.js\", \"index.js\"]);\n\n    await steps.copyFilesFromTemplate_(app, templatePath, targetPath, options);\n\n    const fileMainActivity = `android/app/src/main/java/com/${appNameLowerCase}/MainActivity.java`;\n    await copyFileFromTemplate_(\n        path.join(__dirname, \"changes/MainActivity.java.tpl\"),\n        path.join(targetPath, fileMainActivity),\n        options\n    );\n    app.log(\"info\", `Updated ${fileMainActivity}`);\n\n    await steps.updatePackageJson_(app, targetPath, (config) => {\n        packageConfig.addPackages(config, options);\n        packageConfig.addConfig(config, options);\n        packageConfig.addNpmScripts(config, options);\n    });\n\n    await steps.npmInstall_(app, targetPath, options);\n\n    await steps.runCommand_(app, targetPath, \"npm run pod\");\n    await steps.runCommand_(app, targetPath, \"npm run link\");\n\n    const iosProject = `ios/${options.appName}.xcodeproj/project.pbxproj`;\n    await deleteLines_(path.join(targetPath, iosProject), [\n        \"/* AntDesign.ttf in Resources */\",\n        \"/* Entypo.ttf in Resources */\",\n        \"/* EvilIcons.ttf in Resources */\",\n        \"/* Feather.ttf in Resources */\",\n        \"/* FontAwesome.ttf in Resources */\",\n        \"/* FontAwesome5_Brands.ttf in Resources */\",\n        \"/* FontAwesome5_Regular.ttf in Resources */\",\n        \"/* FontAwesome5_Solid.ttf in Resources */\",\n        \"/* Fontisto.ttf in Resources */\",\n        \"/* Foundation.ttf in Resources */\",\n        \"/* Ionicons.ttf in Resources */\",\n        \"/* MaterialCommunityIcons.ttf in Resources */\",\n        \"/* MaterialIcons.ttf in Resources */\",\n        \"/* Octicons.ttf in Resources */\",\n        \"/* SimpleLineIcons.ttf in Resources */\",\n        \"/* Zocial.ttf in Resources */\",\n    ]);\n    app.log(\"info\", `Patched ${iosProject} for work around \"react-native-vector-icons\" duplicate resources issue.`);\n};\n"],"names":["path","require","fs","localConfig","steps","packageConfig","getTemplatePath","copyFileFromTemplate_","deleteLines_","module","exports","app","options","appNameLowerCase","appName","toLowerCase","targetPath","join","workingPath","appDir","cmd","cwd","existsSync","runCommand_","disablePackageLock","unlink","templatePath","appMode","removeFiles_","copyFilesFromTemplate_","fileMainActivity","__dirname","log","updatePackageJson_","config","addPackages","addConfig","addNpmScripts","npmInstall_","iosProject"],"mappings":";AAAA,MAAMA,OAAOC,QAAQ;AACrB,MAAM,EAAEC,GAAE,EAAE,GAAGD,QAAQ;AACvB,MAAME,cAAcF,QAAQ;AAC5B,MAAM,EAAEG,MAAK,EAAEC,cAAa,EAAE,GAAGJ,QAAQ;AACzC,MAAMK,kBAAkBL,QAAQ;AAChC,MAAMM,wBAAwBN,QAAQ;AACtC,MAAMO,eAAeP,QAAQ;AAE7BQ,OAAOC,OAAO,GAAG,OAAOC,KAAKC,UAAY;IACrC,MAAMC,mBAAmBD,QAAQE,OAAO,CAACC,WAAW;IACpDH,UAAU;QACN,GAAGT,WAAW;QACd,GAAGS,OAAO;QACVC;IACJ;IAEA,MAAMG,aAAahB,KAAKiB,IAAI,CAACL,QAAQM,WAAW,EAAEN,QAAQO,MAAM;IAChE,IAAIC,MAAM,CAAC,sBAAsB,EAAER,QAAQE,OAAO,CAAC,MAAM,CAAC;IAC1D,IAAIO;IAEJ,IAAI,CAACnB,GAAGoB,UAAU,CAACN,aAAa;QAC5BK,MAAMT,QAAQM,WAAW;QACzBE,OAAO,CAAC,aAAa,EAAER,QAAQO,MAAM,CAAC,CAAC;IAC3C,OAAO;QACHE,MAAML;QACNI,OAAO,CAAC,cAAc,CAAC;IAC3B,CAAC;IAED,MAAMhB,MAAMmB,WAAW,CAACZ,KAAKU,KAAKD,KAAK,IAAI;IAE3C,IAAIR,QAAQY,kBAAkB,EAAE;QAC5B,MAAMtB,GAAGuB,MAAM,CAACzB,KAAKiB,IAAI,CAACD,YAAY;IAC1C,CAAC;IAED,MAAMU,eAAepB,gBAAgBM,QAAQe,OAAO;IAEpD,MAAMvB,MAAMwB,YAAY,CAACjB,KAAKK,YAAY;QAAC;QAAY;QAAkB;QAAU;KAAW;IAE9F,MAAMZ,MAAMyB,sBAAsB,CAAClB,KAAKe,cAAcV,YAAYJ;IAElE,MAAMkB,mBAAmB,CAAC,8BAA8B,EAAEjB,iBAAiB,kBAAkB,CAAC;IAC9F,MAAMN,sBACFP,KAAKiB,IAAI,CAACc,WAAW,kCACrB/B,KAAKiB,IAAI,CAACD,YAAYc,mBACtBlB;IAEJD,IAAIqB,GAAG,CAAC,QAAQ,CAAC,QAAQ,EAAEF,iBAAiB,CAAC;IAE7C,MAAM1B,MAAM6B,kBAAkB,CAACtB,KAAKK,YAAY,CAACkB,SAAW;QACxD7B,cAAc8B,WAAW,CAACD,QAAQtB;QAClCP,cAAc+B,SAAS,CAACF,QAAQtB;QAChCP,cAAcgC,aAAa,CAACH,QAAQtB;IACxC;IAEA,MAAMR,MAAMkC,WAAW,CAAC3B,KAAKK,YAAYJ;IAEzC,MAAMR,MAAMmB,WAAW,CAACZ,KAAKK,YAAY;IACzC,MAAMZ,MAAMmB,WAAW,CAACZ,KAAKK,YAAY;IAEzC,MAAMuB,aAAa,CAAC,IAAI,EAAE3B,QAAQE,OAAO,CAAC,0BAA0B,CAAC;IACrE,MAAMN,aAAaR,KAAKiB,IAAI,CAACD,YAAYuB,aAAa;QAClD;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;KACH;IACD5B,IAAIqB,GAAG,CAAC,QAAQ,CAAC,QAAQ,EAAEO,WAAW,uEAAuE,CAAC;AAClH"}