"use strict";Object.defineProperty(exports,"__esModule",{value:true});Object.defineProperty(exports,"default",{enumerable:true,get:function(){return _default}});const _types=require("@galaxar/types");const passportCheck=(options,app)=>{return async(ctx,next)=>{if(ctx.isAuthenticated()){return next()}if(options.successReturnToOrRedirect&&ctx.session){ctx.session.returnTo=ctx.originalUrl||ctx.url}if(!options.loginUrl){ctx.throw(_types.HttpCode.UNAUTHORIZED,"authentication required")}return ctx.redirect(options.loginUrl)}};const _default=passportCheck;
//# sourceMappingURL=passportCheck.js.map