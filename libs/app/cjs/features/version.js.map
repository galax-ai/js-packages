{"version":3,"sources":["../../lib/features/version.js"],"sourcesContent":["/**\n * Set app version\n * @module Feature_Version\n */\n\nimport { fs } from '@galaxar/sys';\nimport Feature from '../Feature';\n\nexport default {\n    /**\n     * This feature is loaded at init stage\n     * @member {string}\n     */\n    stage: Feature.INIT,\n\n    /**\n     * Load the feature\n     * @param {App} app - The cli app module object\n     * @param {string} version - Version information, use '@@package' to use the version info from package.json located under working folder\n     * @returns {Promise.<*>}\n     */\n    load_: async function (app, version) {\n        if (version === '@@package') {\n            let pkgFile = app.toAbsolutePath('package.json');\n            if (!(await fs.exists(pkgFile))) {\n                throw new Error('\"package.json\" not found in working directory. CWD: ' + app.workingPath);\n            }\n\n            let pkg = await fs.readJson(pkgFile);\n            version = pkg.version;\n        }\n\n        app.version = version;\n    },\n};\n"],"names":["stage","Feature","INIT","load_","app","version","pkgFile","toAbsolutePath","fs","exists","Error","workingPath","pkg","readJson"],"mappings":"oGAQA,iDAAA,+BAHmB,gEACC,yGAEpB,SAAe,CAKXA,MAAOC,gBAAO,CAACC,IAAI,CAQnBC,MAAO,eAAgBC,GAAG,CAAEC,OAAO,CAAE,CACjC,GAAIA,UAAY,YAAa,CACzB,IAAIC,QAAUF,IAAIG,cAAc,CAAC,gBACjC,GAAI,CAAE,MAAMC,OAAE,CAACC,MAAM,CAACH,SAAW,CAC7B,MAAM,IAAII,MAAM,uDAAyDN,IAAIO,WAAW,CAAE,AAC9F,CAAC,AAED,IAAIC,IAAM,MAAMJ,OAAE,CAACK,QAAQ,CAACP,SAC5BD,QAAUO,IAAIP,OAAO,AACzB,CAAC,AAEDD,IAAIC,OAAO,CAAGA,OAClB,CACJ"}